CRITICAL - 2024-05-20 14:25:46 --> Undefined property: stdClass::$total
in APPPATH\Views\leads\leads_sources_widget.php on line 16.
 1 APPPATH\Views\leads\leads_sources_widget.php(16): CodeIgniter\Debug\Exceptions->errorHandler(8, 'Undefined property: stdClass::$total', 'APPPATH\\Views\\leads\\leads_sources_widget.php', 16, [...])
 2 SYSTEMPATH\View\View.php(213): include('APPPATH\\Views\\leads\\leads_sources_widget.php')
 3 SYSTEMPATH\View\View.php(216): CodeIgniter\View\View->CodeIgniter\View\{closure}()
 4 SYSTEMPATH\Common.php(1184): CodeIgniter\View\View->render('leads/leads_sources_widget', [], true)
 5 APPPATH\Libraries\Template.php(38): view('leads/leads_sources_widget', [...])
 6 APPPATH\Helpers\widget_helper.php(1830): App\Libraries\Template->view('leads/leads_sources_widget', [...])
 7 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 8 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 9 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
10 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
11 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
12 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
13 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
14 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
15 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:31:36 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ') ? TRUE, FALSE) AS total_leads,
                                COUNT(crm_clie' at line 2 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(684): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:31:36 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ') ? TRUE, FALSE) AS total_leads,
                                COUNT(crm_clie' at line 2
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(684): CodeIgniter\Database\BaseConnection->query('SELECT 
                                COUNT(IF(crm_clients.is_lead = 1) ? TRUE, FALSE) AS total_leads,
                                COUNT(crm_clients.is_lead = 0) AS total_clients,
                               
                                crm_clients.lead_source_id, COALESCE(crm_lead_source.title, \'Outros\') AS title, SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:31:47 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ') ? 1, 0) AS total_leads,
                                COUNT(crm_clients.is_' at line 2 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(684): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:31:47 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ') ? 1, 0) AS total_leads,
                                COUNT(crm_clients.is_' at line 2
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(684): CodeIgniter\Database\BaseConnection->query('SELECT 
                                COUNT(IF(crm_clients.is_lead = 1) ? 1, 0) AS total_leads,
                                COUNT(crm_clients.is_lead = 0) AS total_clients,
                               
                                crm_clients.lead_source_id, COALESCE(crm_lead_source.title, \'Outros\') AS title, SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:34:47 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DISTINCT crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_' at line 8 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:34:47 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DISTINCT crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_' at line 8
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT 
                                SUM(IF(crm_clients.is_lead = 1, 1, 0)) AS total_leads,
                                SUM(IF(crm_clients.is_lead = 0, 1, 0)) AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON DISTINCT crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:45:13 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM (SELECT crm_clients.id FROM crm_clients WHERE crm_clients.is_lead = 1 AND c' at line 2 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:45:13 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM (SELECT crm_clients.id FROM crm_clients WHERE crm_clients.is_lead = 1 AND c' at line 2
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT 
                            COUNT(DISTINCT crm_clients.id FROM (SELECT crm_clients.id FROM crm_clients WHERE crm_clients.is_lead = 1 AND crm_clients.deleted =0 )) AS total_leads,
                            COUNT(DISTINCT crm_clients.id FROM (SELECT crm_clients.id FROM crm_clients WHERE crm_clients.is_lead = 0 AND crm_clients.deleted =0 )) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:45:34 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM (SELECT client.id FROM crm_clients client WHERE crm_clients.is_lead = 1 AND' at line 2 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:45:34 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM (SELECT client.id FROM crm_clients client WHERE crm_clients.is_lead = 1 AND' at line 2
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT 
                            COUNT(DISTINCT client.id FROM (SELECT client.id FROM crm_clients client WHERE crm_clients.is_lead = 1 AND crm_clients.deleted =0 )) AS total_leads,
                            COUNT(DISTINCT crm_clients.id FROM (SELECT crm_clients.id FROM crm_clients WHERE crm_clients.is_lead = 0 AND crm_clients.deleted =0 )) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:46:12 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COUNT(DISTINCT crm_clients.id FROM (SELECT crm_clients.id FROM crm_clients WHERE' at line 3 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:46:12 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COUNT(DISTINCT crm_clients.id FROM (SELECT crm_clients.id FROM crm_clients WHERE' at line 3
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT 
                            COUNT(DISTINCT client.id) FROM (SELECT client.id FROM crm_clients client WHERE crm_clients.is_lead = 1 AND crm_clients.deleted =0 ) AS total_leads,
                            COUNT(DISTINCT crm_clients.id FROM (SELECT crm_clients.id FROM crm_clients WHERE crm_clients.is_lead = 0 AND crm_clients.deleted =0 )) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:46:46 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'lead WHERE crm_clients.is_lead = 1 AND crm_clients.deleted =0 ) AS total_leads,' at line 2 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:46:46 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'lead WHERE crm_clients.is_lead = 1 AND crm_clients.deleted =0 ) AS total_leads,' at line 2
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT 
                            COUNT(DISTINCT lead.id) FROM (SELECT client.id FROM crm_clients lead WHERE crm_clients.is_lead = 1 AND crm_clients.deleted =0 ) AS total_leads,
                            COUNT(DISTINCT client.id) FROM (SELECT client.id FROM crm_clients client  WHERE crm_clients.is_lead = 0 AND crm_clients.deleted =0 ) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:47:12 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'lead WHERE lead.is_lead = 1 AND lead.deleted =0 ) AS total_leads,
             ' at line 2 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:47:12 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'lead WHERE lead.is_lead = 1 AND lead.deleted =0 ) AS total_leads,
             ' at line 2
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT 
                            COUNT(DISTINCT lead.id) FROM (SELECT client.id FROM crm_clients lead WHERE lead.is_lead = 1 AND lead.deleted =0 ) AS total_leads,
                            COUNT(DISTINCT client.id) FROM (SELECT client.id FROM crm_clients client WHERE client.is_lead = 0 AND client.deleted =0 ) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:47:33 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'lead WHERE lead.is_lead = 1 AND lead.deleted =0) AS total_leads,
              ' at line 2 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:47:33 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'lead WHERE lead.is_lead = 1 AND lead.deleted =0) AS total_leads,
              ' at line 2
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT 
                            COUNT(DISTINCT id) FROM (SELECT client.id FROM crm_clients lead WHERE lead.is_lead = 1 AND lead.deleted =0) AS total_leads,
                            COUNT(DISTINCT id) FROM (SELECT client.id FROM crm_clients client WHERE client.is_lead = 0 AND client.deleted =0) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:49:48 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COUNT(DISTINCT id) FROM (SELECT crm_clients.id FROM crm_clients WHERE crm_client' at line 3 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:49:48 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'COUNT(DISTINCT id) FROM (SELECT crm_clients.id FROM crm_clients WHERE crm_client' at line 3
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT 
                            COUNT(DISTINCT id) FROM (SELECT crm_clients.id FROM crm_clients WHERE crm_clients.is_lead = 1 AND crm_clients.deleted =0) AS total_leads,
                            COUNT(DISTINCT id) FROM (SELECT crm_clients.id FROM crm_clients WHERE crm_clients.is_lead = 0 AND crm_clients.deleted =0) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:50:56 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SUM(DISTINCT id) FROM (SELECT crm_clients.id FROM crm_clients WHERE crm_clients.' at line 3 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:50:56 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SUM(DISTINCT id) FROM (SELECT crm_clients.id FROM crm_clients WHERE crm_clients.' at line 3
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT 
                            SUM(DISTINCT id) FROM (SELECT crm_clients.id FROM crm_clients WHERE crm_clients.is_lead = 1 AND crm_clients.deleted =0) AS total_leads,
                            SUM(DISTINCT id) FROM (SELECT crm_clients.id FROM crm_clients WHERE crm_clients.is_lead = 0 AND crm_clients.deleted =0) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:51:23 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SUM(DISTINCT lead_id) FROM (SELECT crm_clients.id AS lead_id FROM crm_clients WH' at line 3 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:51:23 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SUM(DISTINCT lead_id) FROM (SELECT crm_clients.id AS lead_id FROM crm_clients WH' at line 3
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(685): CodeIgniter\Database\BaseConnection->query('SELECT 
                            SUM(DISTINCT client_id) FROM (SELECT crm_clients.id AS client_id FROM crm_clients WHERE crm_clients.is_lead = 1 AND crm_clients.deleted =0) AS total_leads,
                            SUM(DISTINCT lead_id) FROM (SELECT crm_clients.id AS lead_id FROM crm_clients WHERE crm_clients.is_lead = 0 AND crm_clients.deleted =0) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:53:34 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(crm_lead_source.title, 'Outros') AS title, 
                            SUM(cr' at line 7 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(687): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:53:34 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(crm_lead_source.title, 'Outros') AS title, 
                            SUM(cr' at line 7
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(687): CodeIgniter\Database\BaseConnection->query('SELECT 
                            sum(id) from (
                                    select distinct crm_clients.id FROM crm_clients WHERE crm_clients.is_lead=1 AND crm_clients.deleted=0
                            ) AS total_leads,
                          
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:54:06 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(crm_lead_source.title, 'Outros') AS title, 
                            SUM(cr' at line 7 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(687): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:54:06 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(crm_lead_source.title, 'Outros') AS title, 
                            SUM(cr' at line 7
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(687): CodeIgniter\Database\BaseConnection->query('SELECT 
                            sum(id) from (
                                    select distinct crm_clients.id, crm_clients.is_lead FROM crm_clients WHERE crm_clients.is_lead=1 AND crm_clients.deleted=0
                            ) AS total_leads,
                          
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:54:20 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(crm_lead_source.title, 'Outros') AS title, 
                            SUM(cr' at line 7 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(687): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:54:20 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(crm_lead_source.title, 'Outros') AS title, 
                            SUM(cr' at line 7
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(687): CodeIgniter\Database\BaseConnection->query('SELECT 
                            sum(id) from (
                                    select distinct crm_clients.id, crm_clients.is_lead, crm_clients.deleted FROM crm_clients WHERE crm_clients.is_lead=1 AND crm_clients.deleted=0
                            ) AS total_leads,
                          
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:54:38 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(crm_lead_source.title, 'Outros') AS title, 
                            SUM(cr' at line 7 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(687): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:54:38 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(crm_lead_source.title, 'Outros') AS title, 
                            SUM(cr' at line 7
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(687): CodeIgniter\Database\BaseConnection->query('SELECT 
                            COUNT(id) FROM (
                                    select distinct crm_clients.id, crm_clients.is_lead, crm_clients.deleted FROM crm_clients WHERE crm_clients.is_lead=1 AND crm_clients.deleted=0
                            ) AS total_leads,
                          
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:54:43 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(crm_lead_source.title, 'Outros') AS title, 
                            SUM(cr' at line 6 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(686): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:54:43 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(crm_lead_source.title, 'Outros') AS title, 
                            SUM(cr' at line 6
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(686): CodeIgniter\Database\BaseConnection->query('SELECT 
                            COUNT(id) FROM (
                                    select distinct crm_clients.id, crm_clients.is_lead, crm_clients.deleted FROM crm_clients WHERE crm_clients.is_lead=1 AND crm_clients.deleted=0
                            ) AS total_leads,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 14:55:56 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(crm_lead_source.title, 'Outros') AS title, 
                            SUM(cr' at line 6 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(686): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 14:55:56 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(crm_lead_source.title, 'Outros') AS title, 
                            SUM(cr' at line 6
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(686): CodeIgniter\Database\BaseConnection->query('SELECT 
                            COUNT(*) FROM (
                                    select distinct crm_clients.id, crm_clients.is_lead, crm_clients.deleted FROM crm_clients WHERE crm_clients.is_lead=1 AND crm_clients.deleted=0
                            ) AS total_leads,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 
        GROUP BY crm_clients.lead_source_id
        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
CRITICAL - 2024-05-20 14:56:03 --> Undefined property: stdClass::$total_leads
in APPPATH\Views\leads\leads_sources_widget.php on line 16.
 1 APPPATH\Views\leads\leads_sources_widget.php(16): CodeIgniter\Debug\Exceptions->errorHandler(8, 'Undefined property: stdClass::$total_leads', 'APPPATH\\Views\\leads\\leads_sources_widget.php', 16, [...])
 2 SYSTEMPATH\View\View.php(213): include('APPPATH\\Views\\leads\\leads_sources_widget.php')
 3 SYSTEMPATH\View\View.php(216): CodeIgniter\View\View->CodeIgniter\View\{closure}()
 4 SYSTEMPATH\Common.php(1184): CodeIgniter\View\View->render('leads/leads_sources_widget', [], true)
 5 APPPATH\Libraries\Template.php(38): view('leads/leads_sources_widget', [...])
 6 APPPATH\Helpers\widget_helper.php(1830): App\Libraries\Template->view('leads/leads_sources_widget', [...])
 7 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 8 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 9 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
10 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
11 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
12 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
13 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
14 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
15 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:04:25 --> mysqli_sql_exception: Table 'crm_lead_source' from one of the SELECTs cannot be used in global ORDER clause in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(698): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:04:25 --> Table 'crm_lead_source' from one of the SELECTs cannot be used in global ORDER clause
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(698): CodeIgniter\Database\BaseConnection->query('SELECT 
                            0 AS total_leads,
                            SUM(DISTINCT crm_clients.id) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 AND crm_clients.is_leads = 0 
        GROUP BY crm_clients.lead_source_id
        UNION ALL
        SELECT 
                            SUM(DISTINCT crm_clients.id) AS total_leads,
                            0 AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 AND crm_clients.is_leads = 1 
        GROUP BY crm_clients.lead_source_id

        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:04:39 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'UNION ALL
        SELECT 
                            SUM(DISTINCT crm_clients' at line 14 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(700): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:04:39 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'UNION ALL
        SELECT 
                            SUM(DISTINCT crm_clients' at line 14
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(700): CodeIgniter\Database\BaseConnection->query('SELECT 
                            0 AS total_leads,
                            SUM(DISTINCT crm_clients.id) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 AND crm_clients.is_leads = 0 
        GROUP BY crm_clients.lead_source_id

ORDER BY crm_lead_source.sort ASC
        UNION ALL
        SELECT 
                            SUM(DISTINCT crm_clients.id) AS total_leads,
                            0 AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 AND crm_clients.is_leads = 1 
        GROUP BY crm_clients.lead_source_id

        ORDER BY crm_lead_source.sort ASC')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:05:09 --> mysqli_sql_exception: Unknown column 'crm_clients.is_leads' in 'where clause' in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(696): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:05:09 --> Unknown column 'crm_clients.is_leads' in 'where clause'
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(696): CodeIgniter\Database\BaseConnection->query('SELECT 
                            0 AS total_leads,
                            SUM(DISTINCT crm_clients.id) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 AND crm_clients.is_leads = 0 
        GROUP BY crm_clients.lead_source_id
        UNION ALL
        SELECT 
                            SUM(DISTINCT crm_clients.id) AS total_leads,
                            0 AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted=0 AND crm_clients.is_leads = 1 
        GROUP BY crm_clients.lead_source_id')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:06:05 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP BY lead_source_id' at line 24 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(698): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:06:05 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP BY lead_source_id' at line 24
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(698): CodeIgniter\Database\BaseConnection->query('SELECT 
                            0 AS total_leads,
                            SUM(DISTINCT crm_clients.id) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id
        UNION ALL
            SELECT 
                                SUM(DISTINCT crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id
        GROUP BY lead_source_id
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:08:06 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS 1
        UNION ALL
            (SELECT 
                                S' at line 11 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('\r\n             ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('\r\n             ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('\r\n             ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(699): CodeIgniter\Database\BaseConnection->query('\r\n             ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:08:06 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS 1
        UNION ALL
            (SELECT 
                                S' at line 11
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(699): CodeIgniter\Database\BaseConnection->query('
              (SELECT 
                            0 AS total_leads,
                            SUM(DISTINCT crm_clients.id) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id) AS 1
        UNION ALL
            (SELECT 
                                SUM(DISTINCT crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id) AS 2
        GROUP BY lead_source_id
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:08:17 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '1
        UNION ALL
            (SELECT 
                                SUM(' at line 12 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query(' SELECT * FROM\r...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute(' SELECT * FROM\r...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery(' SELECT * FROM\r...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(699): CodeIgniter\Database\BaseConnection->query(' SELECT * FROM\r...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:08:17 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '1
        UNION ALL
            (SELECT 
                                SUM(' at line 12
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(699): CodeIgniter\Database\BaseConnection->query(' SELECT * FROM
              (SELECT 
                            0 AS total_leads,
                            SUM(DISTINCT crm_clients.id) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id) AS 1
        UNION ALL
            (SELECT 
                                SUM(DISTINCT crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id) AS 2
        GROUP BY lead_source_id
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:08:23 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(SELECT 
                            0 AS total_leads,
                       ' at line 2 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query(' SELECT * \r\n   ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute(' SELECT * \r\n   ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery(' SELECT * \r\n   ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(699): CodeIgniter\Database\BaseConnection->query(' SELECT * \r\n   ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:08:23 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(SELECT 
                            0 AS total_leads,
                       ' at line 2
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(699): CodeIgniter\Database\BaseConnection->query(' SELECT * 
              (SELECT 
                            0 AS total_leads,
                            SUM(DISTINCT crm_clients.id) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id) AS 1
        UNION ALL
            (SELECT 
                                SUM(DISTINCT crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id) AS 2
        GROUP BY lead_source_id
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:08:55 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS 1
        UNION ALL
            SELECT 
                                SU' at line 13 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query(' SELECT * FROM\r...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute(' SELECT * FROM\r...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery(' SELECT * FROM\r...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(700): CodeIgniter\Database\BaseConnection->query(' SELECT * FROM\r...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:08:55 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS 1
        UNION ALL
            SELECT 
                                SU' at line 13
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(700): CodeIgniter\Database\BaseConnection->query(' SELECT * FROM
        (
              SELECT 
                            0 AS total_leads,
                            SUM(DISTINCT crm_clients.id) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id AS 1
        UNION ALL
            SELECT 
                                SUM(DISTINCT crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id AS 2)
        GROUP BY lead_source_id
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:09:16 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS 'TESTE'
        UNION ALL
            SELECT 
                            ' at line 12 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query(' SELECT * FROM\r...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute(' SELECT * FROM\r...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery(' SELECT * FROM\r...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(699): CodeIgniter\Database\BaseConnection->query(' SELECT * FROM\r...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:09:16 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS 'TESTE'
        UNION ALL
            SELECT 
                            ' at line 12
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(699): CodeIgniter\Database\BaseConnection->query(' SELECT * FROM
        (
              SELECT 0 AS total_leads,
                            SUM(DISTINCT crm_clients.id) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id AS \'TESTE\'
        UNION ALL
            SELECT 
                                SUM(DISTINCT crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id AS \'TESTES\')
        GROUP BY lead_source_id
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:09:30 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS 'TESTE'
        UNION
            SELECT 
                                ' at line 12 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query(' SELECT * FROM\r...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute(' SELECT * FROM\r...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery(' SELECT * FROM\r...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(699): CodeIgniter\Database\BaseConnection->query(' SELECT * FROM\r...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:09:30 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS 'TESTE'
        UNION
            SELECT 
                                ' at line 12
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(699): CodeIgniter\Database\BaseConnection->query(' SELECT * FROM
        (
              SELECT 0 AS total_leads,
                            SUM(DISTINCT crm_clients.id) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id AS \'TESTE\'
        UNION
            SELECT 
                                SUM(DISTINCT crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id AS \'TESTES\')
        GROUP BY lead_source_id
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:11:07 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS 'TESTE'
        UNION ALL
            SELECT 
                     COUNT(D' at line 18 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query(' SELECT \r\n     ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute(' SELECT \r\n     ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery(' SELECT \r\n     ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(705): CodeIgniter\Database\BaseConnection->query(' SELECT \r\n     ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:11:07 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS 'TESTE'
        UNION ALL
            SELECT 
                     COUNT(D' at line 18
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(705): CodeIgniter\Database\BaseConnection->query(' SELECT 
         SUM(total_leads),
         SUM(total_clients),
         lead_source_id,
         title,
         projects_total
        FROM
        (
              SELECT 0 AS total_leads,
                            COUNT(DISTINCT crm_clients.id) AS total_clients,
                            crm_clients.lead_source_id, 
                            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                            SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id AS \'TESTE\'
        UNION ALL
            SELECT 
                     COUNT(DISTINCT crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id AS \'TESTES\')
        GROUP BY lead_source_id
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:11:30 --> mysqli_sql_exception: Every derived table must have its own alias in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query(' SELECT \r\n     ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute(' SELECT \r\n     ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery(' SELECT \r\n     ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(707): CodeIgniter\Database\BaseConnection->query(' SELECT \r\n     ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:11:30 --> Every derived table must have its own alias
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(707): CodeIgniter\Database\BaseConnection->query(' SELECT 
         SUM(total_leads),
         SUM(total_clients),
         lead_source_id,
         title,
         projects_total
        FROM
        (
              SELECT 
                    0 AS total_leads,
                    COUNT(DISTINCT crm_clients.id) AS total_clients,
                    crm_clients.lead_source_id, 
                    COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                    SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id
        UNION ALL
            SELECT 
                     COUNT(DISTINCT crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id 
        )
        GROUP BY lead_source_id
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:11:50 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'as clients
        UNION ALL
            SELECT 
                     COUNT(D' at line 19 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query(' SELECT \r\n     ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute(' SELECT \r\n     ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery(' SELECT \r\n     ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(707): CodeIgniter\Database\BaseConnection->query(' SELECT \r\n     ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:11:50 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'as clients
        UNION ALL
            SELECT 
                     COUNT(D' at line 19
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(707): CodeIgniter\Database\BaseConnection->query(' SELECT 
         SUM(total_leads),
         SUM(total_clients),
         lead_source_id,
         title,
         projects_total
        FROM
        (
              SELECT 
                    0 AS total_leads,
                    COUNT(DISTINCT crm_clients.id) AS total_clients,
                    crm_clients.lead_source_id, 
                    COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                    SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id as clients
        UNION ALL
            SELECT 
                     COUNT(DISTINCT crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id as leads
        )
        GROUP BY lead_source_id
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:12:18 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'as leads
        GROUP BY lead_source_id' at line 30 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query(' SELECT \r\n     ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute(' SELECT \r\n     ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery(' SELECT \r\n     ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(705): CodeIgniter\Database\BaseConnection->query(' SELECT \r\n     ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:12:18 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'as leads
        GROUP BY lead_source_id' at line 30
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(705): CodeIgniter\Database\BaseConnection->query(' SELECT 
         SUM(total_leads),
         SUM(total_clients),
         lead_source_id,
         title,
         projects_total
        FROM
            (SELECT 
                    0 AS total_leads,
                    COUNT(DISTINCT crm_clients.id) AS total_clients,
                    crm_clients.lead_source_id, 
                    COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                    SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id) as clients
        UNION ALL
            (SELECT 
                     COUNT(DISTINCT crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id) as leads
        GROUP BY lead_source_id
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:12:28 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'as leads' at line 30 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query(' SELECT \r\n     ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute(' SELECT \r\n     ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery(' SELECT \r\n     ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(704): CodeIgniter\Database\BaseConnection->query(' SELECT \r\n     ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:12:28 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'as leads' at line 30
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(704): CodeIgniter\Database\BaseConnection->query(' SELECT 
         SUM(total_leads),
         SUM(total_clients),
         lead_source_id,
         title,
         projects_total
        FROM
            (SELECT 
                    0 AS total_leads,
                    COUNT(DISTINCT crm_clients.id) AS total_clients,
                    crm_clients.lead_source_id, 
                    COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                    SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id) as clients
        UNION ALL
            (SELECT 
                     COUNT(DISTINCT crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id) as leads
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:13:55 --> mysqli_sql_exception: Every derived table must have its own alias in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT\r\n       ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT\r\n       ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT\r\n       ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(704): CodeIgniter\Database\BaseConnection->query('SELECT\r\n       ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:13:55 --> Every derived table must have its own alias
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(704): CodeIgniter\Database\BaseConnection->query('SELECT
             SUM(total_leads),
             SUM(total_clients),
             lead_source_id,
             title,
             projects_total
    FROM(
        SELECT 
                    0 AS total_leads,
                    COUNT(DISTINCT crm_clients.id) AS total_clients,
                    crm_clients.lead_source_id, 
                    COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                    SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id
        UNION ALL
            SELECT 
                     COUNT(DISTINCT crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id)
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:14:09 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS client
        UNION ALL
            SELECT 
                     COUNT(DI' at line 18 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT\r\n       ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT\r\n       ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT\r\n       ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(704): CodeIgniter\Database\BaseConnection->query('SELECT\r\n       ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:14:09 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS client
        UNION ALL
            SELECT 
                     COUNT(DI' at line 18
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(704): CodeIgniter\Database\BaseConnection->query('SELECT
             SUM(total_leads),
             SUM(total_clients),
             lead_source_id,
             title,
             projects_total
    FROM(
        SELECT 
                    0 AS total_leads,
                    COUNT(DISTINCT crm_clients.id) AS total_clients,
                    crm_clients.lead_source_id, 
                    COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                    SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id AS client
        UNION ALL
            SELECT 
                     COUNT(DISTINCT crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id AS lead)
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:14:26 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS lead)' at line 30 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT\r\n       ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT\r\n       ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT\r\n       ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(704): CodeIgniter\Database\BaseConnection->query('SELECT\r\n       ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:14:26 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS lead)' at line 30
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(704): CodeIgniter\Database\BaseConnection->query('SELECT
             SUM(total_leads),
             SUM(total_clients),
             lead_source_id,
             title,
             projects_total
    FROM(
        SELECT 
                    0 AS total_leads,
                    COUNT(DISTINCT crm_clients.id) AS total_clients,
                    crm_clients.lead_source_id, 
                    COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                    SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id) AS client
        UNION ALL
            (SELECT 
                     COUNT(DISTINCT crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id AS lead)
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:15:07 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''client'
        UNION ALL
            (SELECT 
                     COUNT(DI' at line 18 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT\r\n       ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT\r\n       ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT\r\n       ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(704): CodeIgniter\Database\BaseConnection->query('SELECT\r\n       ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:15:07 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''client'
        UNION ALL
            (SELECT 
                     COUNT(DI' at line 18
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(704): CodeIgniter\Database\BaseConnection->query('SELECT
             SUM(total_leads),
             SUM(total_clients),
             lead_source_id,
             title,
             projects_total
    FROM(
        SELECT 
                    0 AS total_leads,
                    COUNT(DISTINCT crm_clients.id) AS total_clients,
                    crm_clients.lead_source_id, 
                    COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                    SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id) AS \'client\'
        UNION ALL
            (SELECT 
                     COUNT(DISTINCT crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id AS \'lead\')
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:15:21 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''client'
        UNION ALL
            (SELECT 
                     COUNT(cr' at line 18 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT\r\n       ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT\r\n       ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT\r\n       ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(704): CodeIgniter\Database\BaseConnection->query('SELECT\r\n       ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:15:21 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''client'
        UNION ALL
            (SELECT 
                     COUNT(cr' at line 18
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(704): CodeIgniter\Database\BaseConnection->query('SELECT
             SUM(total_leads),
             SUM(total_clients),
             lead_source_id,
             title,
             projects_total
    FROM(
        SELECT 
                    0 AS total_leads,
                    COUNT(crm_clients.id) AS total_clients,
                    crm_clients.lead_source_id, 
                    COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                    SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id) AS \'client\'
        UNION ALL
            (SELECT 
                     COUNT(crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id AS \'lead\')
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:15:43 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''client'
        UNION ALL
            (SELECT 
                     COUNT(cr' at line 18 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT\r\n       ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT\r\n       ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT\r\n       ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(705): CodeIgniter\Database\BaseConnection->query('SELECT\r\n       ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:15:43 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''client'
        UNION ALL
            (SELECT 
                     COUNT(cr' at line 18
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(705): CodeIgniter\Database\BaseConnection->query('SELECT
             SUM(total_leads),
             SUM(total_clients),
             lead_source_id,
             title,
             projects_total
    FROM(
        SELECT 
                    0 AS total_leads,
                    COUNT(crm_clients.id) AS total_clients,
                    crm_clients.lead_source_id, 
                    COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                    SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id) AS \'client\'
        UNION ALL
            (SELECT 
                     COUNT(crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id AS \'lead\')
            GROUP BY lead_source_id
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:15:54 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''client'
        UNION ALL
            (SELECT 
                     COUNT(cr' at line 18 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT\r\n       ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT\r\n       ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT\r\n       ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(705): CodeIgniter\Database\BaseConnection->query('SELECT\r\n       ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:15:54 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''client'
        UNION ALL
            (SELECT 
                     COUNT(cr' at line 18
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(705): CodeIgniter\Database\BaseConnection->query('SELECT
             SUM(total_leads),
             SUM(total_clients),
             lead_source_id,
             title,
             projects_total
    FROM(
        SELECT 
                    0 AS total_leads,
                    COUNT(crm_clients.id) AS total_clients,
                    crm_clients.lead_source_id, 
                    COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                    SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id) AS \'client\'
        UNION ALL
            (SELECT 
                     COUNT(crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id) AS \'lead\'
            GROUP BY lead_source_id
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:16:03 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''client'
        UNION ALL
            (SELECT 
                     COUNT(cr' at line 18 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT\r\n       ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT\r\n       ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT\r\n       ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(705): CodeIgniter\Database\BaseConnection->query('SELECT\r\n       ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:16:03 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''client'
        UNION ALL
            (SELECT 
                     COUNT(cr' at line 18
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(705): CodeIgniter\Database\BaseConnection->query('SELECT
             SUM(total_leads),
             SUM(total_clients),
             lead_source_id,
             title,
             projects_total
    FROM
        (SELECT 
                    0 AS total_leads,
                    COUNT(crm_clients.id) AS total_clients,
                    crm_clients.lead_source_id, 
                    COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                    SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id) AS \'client\'
        UNION ALL
            (SELECT 
                     COUNT(crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id) AS \'lead\'
            GROUP BY lead_source_id
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:16:08 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''client'
        UNION ALL
            (SELECT 
                     COUNT(cr' at line 18 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT\r\n       ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT\r\n       ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT\r\n       ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(704): CodeIgniter\Database\BaseConnection->query('SELECT\r\n       ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:16:08 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''client'
        UNION ALL
            (SELECT 
                     COUNT(cr' at line 18
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(704): CodeIgniter\Database\BaseConnection->query('SELECT
             SUM(total_leads),
             SUM(total_clients),
             lead_source_id,
             title,
             projects_total
    FROM
        (SELECT 
                    0 AS total_leads,
                    COUNT(crm_clients.id) AS total_clients,
                    crm_clients.lead_source_id, 
                    COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                    SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 0 
            GROUP BY crm_clients.lead_source_id) AS \'client\'
        UNION ALL
            (SELECT 
                     COUNT(crm_clients.id) AS total_leads,
                                0 AS total_clients,
                                crm_clients.lead_source_id, 
                                COALESCE(crm_lead_source.title, \'Outros\') AS title, 
                                SUM(crm_projects.price) AS projects_total
            FROM crm_clients
            LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
            LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
            WHERE crm_clients.deleted=0 AND crm_clients.is_lead = 1 
            GROUP BY crm_clients.lead_source_id) AS \'lead\'
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:18:06 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 34 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT\r\n       ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT\r\n       ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT\r\n       ...')
#3 E:\httpdocs\www\crm\app\Models\Clients_model.php(708): CodeIgniter\Database\BaseConnection->query('SELECT\r\n       ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources(Array, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1237): leads_sources_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:18:06 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 34
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Clients_model.php(708): CodeIgniter\Database\BaseConnection->query('SELECT
        SUM(total_leads) AS total_leads,
        SUM(total_clients) AS total_clients,
        lead_source_id,
        title,
        SUM(projects_total) AS projects_total
    FROM (
        SELECT 
            0 AS total_leads,
            COUNT(crm_clients.id) AS total_clients,
            crm_clients.lead_source_id, 
            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted = 0 AND crm_clients.is_lead = 0 
        GROUP BY crm_clients.lead_source_id, crm_lead_source.title
    
        UNION ALL
    
        SELECT 
            COUNT(crm_clients.id) AS total_leads,
            0 AS total_clients,
            crm_clients.lead_source_id, 
            COALESCE(crm_lead_source.title, \'Outros\') AS title, 
            SUM(crm_projects.price) AS projects_total
        FROM crm_clients
        LEFT JOIN crm_lead_source ON crm_lead_source.id = crm_clients.lead_source_id
        LEFT JOIN crm_projects ON crm_projects.client_id = crm_clients.id
        WHERE crm_clients.deleted = 0 AND crm_clients.is_lead = 1 
        GROUP BY crm_clients.lead_source_id, crm_lead_source.title
    ) AS combined
    GROUP BY lead_source_id,
        ')
 2 APPPATH\Helpers\widget_helper.php(1824): App\Models\Clients_model->get_lead_sources([], null, null)
 3 APPPATH\Controllers\Dashboard.php(1237): leads_sources_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('leads_sources', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('leads_sources')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:29:04 --> mysqli_sql_exception: Unknown column 'items_table.estimate_value' in 'field list' in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query(' SELECT \r\n    u...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute(' SELECT \r\n    u...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery(' SELECT \r\n    u...')
#3 E:\httpdocs\www\crm\app\Models\Users_model.php(526): CodeIgniter\Database\BaseConnection->query(' SELECT \r\n    u...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers(Array, false, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_o...', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_o...')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:29:04 --> Unknown column 'items_table.estimate_value' in 'field list'
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Users_model.php(526): CodeIgniter\Database\BaseConnection->query(' SELECT 
    users.id,
    users.first_name, 
    users.last_name, 
    COALESCE(SUM(estimates_values.value), SUM(items_table.estimate_value)) AS total_sells,
    COALESCE(COUNT(DISTINCT estimates.id), 0) AS total_projects,
    COALESCE(SUM(clients_total), 0) AS total_clients,
    COALESCE(SUM(leads_total), 0) AS total_leads,
    COALESCE(SUM(prospects_total), 0) AS total_prospects,
    users.user_type, 
    users.image,  
    users.job_title, 
    users.last_online
FROM 
    crm_users AS users
LEFT JOIN (
    SELECT 
        crm_clients.owner_id,
        CASE 
            WHEN crm_clients.is_lead = 0 THEN COUNT(DISTINCT crm_clients.id)
            ELSE 0
        END AS clients_total,
        CASE 
            WHEN crm_clients.is_lead = 1 AND crm_clients.lead_status_id = 1 THEN COUNT(DISTINCT crm_clients.id)
            ELSE 0
        END AS leads_total,
        CASE 
            WHEN crm_clients.is_lead = 1 AND crm_clients.lead_status_id > 1 THEN COUNT(DISTINCT crm_clients.id)
            ELSE 0
        END AS prospects_total
    FROM crm_clients
    WHERE crm_clients.deleted = 0
    GROUP BY crm_clients.owner_id, crm_clients.is_lead, crm_clients.lead_status_id
) AS client_lead_prospect_totals ON client_lead_prospect_totals.owner_id = users.id
LEFT JOIN (
    SELECT 
        crm_estimates.id,
        crm_estimates.client_id,
        crm_clients.owner_id,
        SUM(crm_custom_field_values.value) AS value,
        COUNT(DISTINCT crm_estimates.id) AS total_projects
    FROM crm_estimates
    LEFT JOIN crm_custom_field_values ON crm_custom_field_values.custom_field_id = (
        SELECT id 
        FROM crm_custom_fields 
        WHERE crm_custom_fields.related_to = \'estimates\' 
          AND crm_custom_fields.placeholder = \'Valor Estimado\'
    ) AND crm_custom_field_values.related_to_id = crm_estimates.id
    LEFT JOIN (
        SELECT 
            estimate_id, 
            SUM(total) AS estimate_value 
        FROM crm_estimate_items
        INNER JOIN crm_items ON crm_items.id = crm_estimate_items.item_id
        WHERE crm_estimate_items.deleted = 0 
        GROUP BY estimate_id
    ) AS items_table ON items_table.estimate_id = crm_estimates.id
    INNER JOIN crm_clients ON crm_clients.id = crm_estimates.client_id
    WHERE crm_estimates.deleted = 0
    GROUP BY crm_estimates.client_id, crm_clients.owner_id
) AS estimates_values ON estimates_values.owner_id = users.id
WHERE 
    users.deleted = 0 
    AND users.status = \'active\' 
     AND crm_users.role_id IN (6, 8, 9, 10)
GROUP BY 
    users.id;
        ')
 2 APPPATH\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers([...], false, null, null)
 3 APPPATH\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_overview', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_overview')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:30:52 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 81 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Users_model.php(540): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers(Array, false, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_o...', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_o...')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:30:52 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 81
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Users_model.php(540): CodeIgniter\Database\BaseConnection->query('SELECT 
        users.id,
        users.first_name, 
        users.last_name, 
        COALESCE(SUM(total_sells), 0) AS total_sells,
        COALESCE(SUM(total_projects), 0) AS total_projects,
        COALESCE(SUM(total_clients), 0) AS total_clients,
        COALESCE(SUM(total_leads), 0) AS total_leads,
        COALESCE(SUM(total_prospects), 0) AS total_prospects,
        users.user_type, 
        users.image,  
        users.job_title, 
        users.last_online
    FROM (
        SELECT 
                    crm_users.id,
                    crm_users.first_name, 
                    crm_users.last_name, 
                    COALESCE(SUM(crm_custom_field_values.value), SUM(estimate_value)) AS total_sells,
                    COALESCE(COUNT(DISTINCT crm_estimates.id), 0) AS total_projects,
                    COALESCE(COUNT(DISTINCT clients.id), 0) AS total_clients,
                    0 AS total_leads,
                    0 AS total_prospects,
                    crm_users.user_type, 
                    crm_users.image,  
                    crm_users.job_title, 
                    crm_users.last_online
            FROM crm_estimates
            INNER JOIN crm_clients AS clients ON clients.id = crm_estimates.client_id AND clients.is_lead = 0 AND clients.deleted = 0
            INNER JOIN crm_users ON crm_users.id = clients.owner_id
            LEFT JOIN crm_custom_fields ON crm_custom_fields.related_to = \'estimates\' AND crm_custom_fields.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values ON crm_custom_field_values.custom_field_id = crm_custom_fields.id AND crm_custom_field_values.related_to_id = crm_estimates.id
            LEFT JOIN (SELECT estimate_id, SUM(total) AS estimate_value FROM crm_estimate_items INNER JOIN crm_items ON crm_items.id = crm_estimate_items.item_id WHERE crm_estimate_items.deleted = 0 GROUP BY estimate_id) AS items_table ON items_table.estimate_id = crm_estimates.id 
            WHERE crm_users.deleted=0 AND crm_estimates.deleted=0 AND crm_users.status=\'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            GROUP BY crm_users.id
        UNION ALL
            SELECT 
                    crm_users.id,
                    crm_users.first_name, 
                    crm_users.last_name, 
                    COALESCE(SUM(crm_custom_field_values.value), SUM(estimate_value)) AS total_sells,
                    COALESCE(COUNT(DISTINCT crm_estimates.id), 0) AS total_projects,
                    0 AS total_clients,
                    COALESCE(COUNT(DISTINCT leads.id), 0) AS total_leads,
                    0 AS total_prospects,
                    crm_users.user_type, 
                    crm_users.image,  
                    crm_users.job_title, 
                    crm_users.last_online
            FROM crm_estimates
            INNER JOIN crm_clients AS leads ON leads.id = crm_estimates.client_id AND leads.is_lead = 1 AND leads.lead_status_id = 1 AND leads.deleted = 0
            INNER JOIN crm_users ON crm_users.id = leads.owner_id 
            LEFT JOIN crm_custom_fields ON crm_custom_fields.related_to = \'estimates\' AND crm_custom_fields.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values ON crm_custom_field_values.custom_field_id = crm_custom_fields.id AND crm_custom_field_values.related_to_id = crm_estimates.id
            LEFT JOIN (SELECT estimate_id, SUM(total) AS estimate_value FROM crm_estimate_items INNER JOIN crm_items ON crm_items.id = crm_estimate_items.item_id WHERE crm_estimate_items.deleted = 0 GROUP BY estimate_id) AS items_table ON items_table.estimate_id = crm_estimates.id 
            WHERE crm_users.deleted=0 AND crm_estimates.deleted=0 AND crm_users.status=\'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            
        UNION ALL
            SELECT 
                    crm_users.id,
                    crm_users.first_name, 
                    crm_users.last_name, 
                    COALESCE(SUM(crm_custom_field_values.value), SUM(estimate_value)) AS total_sells,
                    COALESCE(COUNT(DISTINCT crm_estimates.id), 0) AS total_projects,
                    0 AS total_clients,
                    0 AS total_leads,
                    COALESCE(COUNT(DISTINCT prospect.id), 0) AS total_prospects,
                    crm_users.user_type, 
                    crm_users.image,  
                    crm_users.job_title, 
                    crm_users.last_online
            FROM crm_estimates
            INNER JOIN crm_clients AS prospect ON prospect.id = crm_estimates.client_id AND prospect.is_lead = 1 AND prospect.lead_status_id > 1 AND prospect.deleted = 0
            INNER JOIN crm_users ON crm_users.id = prospect.owner_id
            LEFT JOIN crm_custom_fields ON crm_custom_fields.related_to = \'estimates\' AND crm_custom_fields.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values ON crm_custom_field_values.custom_field_id = crm_custom_fields.id AND crm_custom_field_values.related_to_id = crm_estimates.id
            LEFT JOIN (SELECT estimate_id, SUM(total) AS estimate_value FROM crm_estimate_items INNER JOIN crm_items ON crm_items.id = crm_estimate_items.item_id WHERE crm_estimate_items.deleted = 0 GROUP BY estimate_id) AS items_table ON items_table.estimate_id = crm_estimates.id 
            WHERE crm_users.deleted=0 AND crm_estimates.deleted=0 AND crm_users.status=\'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            ) AS combined
GROUP BY 
    users.id,
        ')
 2 APPPATH\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers([...], false, null, null)
 3 APPPATH\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_overview', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_overview')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:31:05 --> mysqli_sql_exception: Unknown column 'users.id' in 'field list' in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('SELECT \r\n      ...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('SELECT \r\n      ...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('SELECT \r\n      ...')
#3 E:\httpdocs\www\crm\app\Models\Users_model.php(539): CodeIgniter\Database\BaseConnection->query('SELECT \r\n      ...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers(Array, false, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_o...', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_o...')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:31:05 --> Unknown column 'users.id' in 'field list'
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Users_model.php(539): CodeIgniter\Database\BaseConnection->query('SELECT 
        users.id,
        users.first_name, 
        users.last_name, 
        COALESCE(SUM(total_sells), 0) AS total_sells,
        COALESCE(SUM(total_projects), 0) AS total_projects,
        COALESCE(SUM(total_clients), 0) AS total_clients,
        COALESCE(SUM(total_leads), 0) AS total_leads,
        COALESCE(SUM(total_prospects), 0) AS total_prospects,
        users.user_type, 
        users.image,  
        users.job_title, 
        users.last_online
    FROM (
        SELECT 
                    crm_users.id,
                    crm_users.first_name, 
                    crm_users.last_name, 
                    COALESCE(SUM(crm_custom_field_values.value), SUM(estimate_value)) AS total_sells,
                    COALESCE(COUNT(DISTINCT crm_estimates.id), 0) AS total_projects,
                    COALESCE(COUNT(DISTINCT clients.id), 0) AS total_clients,
                    0 AS total_leads,
                    0 AS total_prospects,
                    crm_users.user_type, 
                    crm_users.image,  
                    crm_users.job_title, 
                    crm_users.last_online
            FROM crm_estimates
            INNER JOIN crm_clients AS clients ON clients.id = crm_estimates.client_id AND clients.is_lead = 0 AND clients.deleted = 0
            INNER JOIN crm_users ON crm_users.id = clients.owner_id
            LEFT JOIN crm_custom_fields ON crm_custom_fields.related_to = \'estimates\' AND crm_custom_fields.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values ON crm_custom_field_values.custom_field_id = crm_custom_fields.id AND crm_custom_field_values.related_to_id = crm_estimates.id
            LEFT JOIN (SELECT estimate_id, SUM(total) AS estimate_value FROM crm_estimate_items INNER JOIN crm_items ON crm_items.id = crm_estimate_items.item_id WHERE crm_estimate_items.deleted = 0 GROUP BY estimate_id) AS items_table ON items_table.estimate_id = crm_estimates.id 
            WHERE crm_users.deleted=0 AND crm_estimates.deleted=0 AND crm_users.status=\'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            GROUP BY crm_users.id
        UNION ALL
            SELECT 
                    crm_users.id,
                    crm_users.first_name, 
                    crm_users.last_name, 
                    COALESCE(SUM(crm_custom_field_values.value), SUM(estimate_value)) AS total_sells,
                    COALESCE(COUNT(DISTINCT crm_estimates.id), 0) AS total_projects,
                    0 AS total_clients,
                    COALESCE(COUNT(DISTINCT leads.id), 0) AS total_leads,
                    0 AS total_prospects,
                    crm_users.user_type, 
                    crm_users.image,  
                    crm_users.job_title, 
                    crm_users.last_online
            FROM crm_estimates
            INNER JOIN crm_clients AS leads ON leads.id = crm_estimates.client_id AND leads.is_lead = 1 AND leads.lead_status_id = 1 AND leads.deleted = 0
            INNER JOIN crm_users ON crm_users.id = leads.owner_id 
            LEFT JOIN crm_custom_fields ON crm_custom_fields.related_to = \'estimates\' AND crm_custom_fields.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values ON crm_custom_field_values.custom_field_id = crm_custom_fields.id AND crm_custom_field_values.related_to_id = crm_estimates.id
            LEFT JOIN (SELECT estimate_id, SUM(total) AS estimate_value FROM crm_estimate_items INNER JOIN crm_items ON crm_items.id = crm_estimate_items.item_id WHERE crm_estimate_items.deleted = 0 GROUP BY estimate_id) AS items_table ON items_table.estimate_id = crm_estimates.id 
            WHERE crm_users.deleted=0 AND crm_estimates.deleted=0 AND crm_users.status=\'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            
        UNION ALL
            SELECT 
                    crm_users.id,
                    crm_users.first_name, 
                    crm_users.last_name, 
                    COALESCE(SUM(crm_custom_field_values.value), SUM(estimate_value)) AS total_sells,
                    COALESCE(COUNT(DISTINCT crm_estimates.id), 0) AS total_projects,
                    0 AS total_clients,
                    0 AS total_leads,
                    COALESCE(COUNT(DISTINCT prospect.id), 0) AS total_prospects,
                    crm_users.user_type, 
                    crm_users.image,  
                    crm_users.job_title, 
                    crm_users.last_online
            FROM crm_estimates
            INNER JOIN crm_clients AS prospect ON prospect.id = crm_estimates.client_id AND prospect.is_lead = 1 AND prospect.lead_status_id > 1 AND prospect.deleted = 0
            INNER JOIN crm_users ON crm_users.id = prospect.owner_id
            LEFT JOIN crm_custom_fields ON crm_custom_fields.related_to = \'estimates\' AND crm_custom_fields.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values ON crm_custom_field_values.custom_field_id = crm_custom_fields.id AND crm_custom_field_values.related_to_id = crm_estimates.id
            LEFT JOIN (SELECT estimate_id, SUM(total) AS estimate_value FROM crm_estimate_items INNER JOIN crm_items ON crm_items.id = crm_estimate_items.item_id WHERE crm_estimate_items.deleted = 0 GROUP BY estimate_id) AS items_table ON items_table.estimate_id = crm_estimates.id 
            WHERE crm_users.deleted=0 AND crm_estimates.deleted=0 AND crm_users.status=\'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            ) AS combined
        GROUP BY 
    users.id')
 2 APPPATH\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers([...], false, null, null)
 3 APPPATH\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_overview', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_overview')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:43:55 --> mysqli_sql_exception: Unknown column 'crm_users.role_id' in 'where clause' in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('WITH FilteredEs...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('WITH FilteredEs...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('WITH FilteredEs...')
#3 E:\httpdocs\www\crm\app\Models\Users_model.php(582): CodeIgniter\Database\BaseConnection->query('WITH FilteredEs...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers(Array, false, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_o...', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_o...')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:43:55 --> Unknown column 'crm_users.role_id' in 'where clause'
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Users_model.php(582): CodeIgniter\Database\BaseConnection->query('WITH FilteredEstimates AS (
            SELECT
                e.*,
                CASE
                    WHEN e.estimate_number LIKE \'%Rev%\' THEN
                        LEFT(e.estimate_number, CHAR_LENGTH(e.estimate_number) - 3)
                    ELSE e.estimate_number
                END AS base_estimate_number
            FROM crm_estimates e
            WHERE e.deleted = 0
        ),
        ValidEstimates AS (
            SELECT
                e.*
            FROM FilteredEstimates e
            LEFT JOIN FilteredEstimates rev
            ON e.estimate_number = rev.base_estimate_number
            AND rev.estimate_number LIKE \'%Rev%\'
            WHERE rev.estimate_number IS NULL
        )
        SELECT 
            id,
            first_name, 
            last_name, 
            COALESCE(SUM(total_sells), 0) AS total_sells,
            COALESCE(SUM(total_projects), 0) AS total_projects,
            COALESCE(SUM(total_clients), 0) AS total_clients,
            COALESCE(SUM(total_leads), 0) AS total_leads,
            COALESCE(SUM(total_prospects), 0) AS total_prospects,
            user_type, 
            image,  
            job_title, 
            last_online
        FROM (
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                COUNT(DISTINCT clients.id) AS total_clients,
                0 AS total_leads,
                0 AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS clients ON clients.id = ve.client_id AND clients.is_lead = 0 AND clients.deleted = 0
            LEFT JOIN crm_users u ON u.id = clients.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND u.status = \'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            GROUP BY u.id
        
            UNION ALL
        
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                0 AS total_clients,
                COUNT(DISTINCT leads.id) AS total_leads,
                0 AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS leads ON leads.id = ve.client_id AND leads.is_lead = 1 AND leads.lead_status_id = 1 AND leads.deleted = 0
            LEFT JOIN crm_users u ON u.id = leads.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND ve.deleted = 0 AND u.status = \'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            GROUP BY u.id
        
            UNION ALL
        
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                0 AS total_clients,
                0 AS total_leads,
                COUNT(DISTINCT prospect.id) AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS prospect ON prospect.id = ve.client_id AND prospect.is_lead = 1 AND prospect.lead_status_id > 1 AND prospect.deleted = 0
            LEFT JOIN crm_users u ON u.id = prospect.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND ve.deleted = 0 AND u.status = \'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            GROUP BY u.id
        ) AS combined
        GROUP BY 
            id')
 2 APPPATH\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers([...], false, null, null)
 3 APPPATH\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_overview', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_overview')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:43:56 --> mysqli_sql_exception: Unknown column 'crm_users.role_id' in 'where clause' in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('WITH FilteredEs...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('WITH FilteredEs...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('WITH FilteredEs...')
#3 E:\httpdocs\www\crm\app\Models\Users_model.php(582): CodeIgniter\Database\BaseConnection->query('WITH FilteredEs...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers(Array, false, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_o...', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_o...')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:43:56 --> Unknown column 'crm_users.role_id' in 'where clause'
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Users_model.php(582): CodeIgniter\Database\BaseConnection->query('WITH FilteredEstimates AS (
            SELECT
                e.*,
                CASE
                    WHEN e.estimate_number LIKE \'%Rev%\' THEN
                        LEFT(e.estimate_number, CHAR_LENGTH(e.estimate_number) - 3)
                    ELSE e.estimate_number
                END AS base_estimate_number
            FROM crm_estimates e
            WHERE e.deleted = 0
        ),
        ValidEstimates AS (
            SELECT
                e.*
            FROM FilteredEstimates e
            LEFT JOIN FilteredEstimates rev
            ON e.estimate_number = rev.base_estimate_number
            AND rev.estimate_number LIKE \'%Rev%\'
            WHERE rev.estimate_number IS NULL
        )
        SELECT 
            id,
            first_name, 
            last_name, 
            COALESCE(SUM(total_sells), 0) AS total_sells,
            COALESCE(SUM(total_projects), 0) AS total_projects,
            COALESCE(SUM(total_clients), 0) AS total_clients,
            COALESCE(SUM(total_leads), 0) AS total_leads,
            COALESCE(SUM(total_prospects), 0) AS total_prospects,
            user_type, 
            image,  
            job_title, 
            last_online
        FROM (
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                COUNT(DISTINCT clients.id) AS total_clients,
                0 AS total_leads,
                0 AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS clients ON clients.id = ve.client_id AND clients.is_lead = 0 AND clients.deleted = 0
            LEFT JOIN crm_users u ON u.id = clients.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND u.status = \'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            GROUP BY u.id
        
            UNION ALL
        
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                0 AS total_clients,
                COUNT(DISTINCT leads.id) AS total_leads,
                0 AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS leads ON leads.id = ve.client_id AND leads.is_lead = 1 AND leads.lead_status_id = 1 AND leads.deleted = 0
            LEFT JOIN crm_users u ON u.id = leads.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND ve.deleted = 0 AND u.status = \'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            GROUP BY u.id
        
            UNION ALL
        
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                0 AS total_clients,
                0 AS total_leads,
                COUNT(DISTINCT prospect.id) AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS prospect ON prospect.id = ve.client_id AND prospect.is_lead = 1 AND prospect.lead_status_id > 1 AND prospect.deleted = 0
            LEFT JOIN crm_users u ON u.id = prospect.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND ve.deleted = 0 AND u.status = \'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            GROUP BY u.id
        ) AS combined
        GROUP BY 
            id')
 2 APPPATH\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers([...], false, null, null)
 3 APPPATH\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_overview', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_overview')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:44:01 --> mysqli_sql_exception: Unknown column 'crm_users.role_id' in 'where clause' in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('WITH FilteredEs...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('WITH FilteredEs...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('WITH FilteredEs...')
#3 E:\httpdocs\www\crm\app\Models\Users_model.php(582): CodeIgniter\Database\BaseConnection->query('WITH FilteredEs...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers(Array, false, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_o...', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_o...')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:44:01 --> Unknown column 'crm_users.role_id' in 'where clause'
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Users_model.php(582): CodeIgniter\Database\BaseConnection->query('WITH FilteredEstimates AS (
            SELECT
                e.*,
                CASE
                    WHEN e.estimate_number LIKE \'%Rev%\' THEN
                        LEFT(e.estimate_number, CHAR_LENGTH(e.estimate_number) - 3)
                    ELSE e.estimate_number
                END AS base_estimate_number
            FROM crm_estimates e
            WHERE e.deleted = 0
        ),
        ValidEstimates AS (
            SELECT
                e.*
            FROM FilteredEstimates e
            LEFT JOIN FilteredEstimates rev
            ON e.estimate_number = rev.base_estimate_number
            AND rev.estimate_number LIKE \'%Rev%\'
            WHERE rev.estimate_number IS NULL
        )
        SELECT 
            id,
            first_name, 
            last_name, 
            COALESCE(SUM(total_sells), 0) AS total_sells,
            COALESCE(SUM(total_projects), 0) AS total_projects,
            COALESCE(SUM(total_clients), 0) AS total_clients,
            COALESCE(SUM(total_leads), 0) AS total_leads,
            COALESCE(SUM(total_prospects), 0) AS total_prospects,
            user_type, 
            image,  
            job_title, 
            last_online
        FROM (
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                COUNT(DISTINCT clients.id) AS total_clients,
                0 AS total_leads,
                0 AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS clients ON clients.id = ve.client_id AND clients.is_lead = 0 AND clients.deleted = 0
            LEFT JOIN crm_users u ON u.id = clients.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND u.status = \'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            GROUP BY u.id
        
            UNION ALL
        
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                0 AS total_clients,
                COUNT(DISTINCT leads.id) AS total_leads,
                0 AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS leads ON leads.id = ve.client_id AND leads.is_lead = 1 AND leads.lead_status_id = 1 AND leads.deleted = 0
            LEFT JOIN crm_users u ON u.id = leads.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND ve.deleted = 0 AND u.status = \'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            GROUP BY u.id
        
            UNION ALL
        
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                0 AS total_clients,
                0 AS total_leads,
                COUNT(DISTINCT prospect.id) AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS prospect ON prospect.id = ve.client_id AND prospect.is_lead = 1 AND prospect.lead_status_id > 1 AND prospect.deleted = 0
            LEFT JOIN crm_users u ON u.id = prospect.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND ve.deleted = 0 AND u.status = \'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            GROUP BY u.id
        ) AS combined
        GROUP BY 
            id')
 2 APPPATH\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers([...], false, null, null)
 3 APPPATH\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_overview', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_overview')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:44:02 --> mysqli_sql_exception: Unknown column 'crm_users.role_id' in 'where clause' in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('WITH FilteredEs...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('WITH FilteredEs...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('WITH FilteredEs...')
#3 E:\httpdocs\www\crm\app\Models\Users_model.php(582): CodeIgniter\Database\BaseConnection->query('WITH FilteredEs...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers(Array, false, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_o...', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_o...')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:44:02 --> Unknown column 'crm_users.role_id' in 'where clause'
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Users_model.php(582): CodeIgniter\Database\BaseConnection->query('WITH FilteredEstimates AS (
            SELECT
                e.*,
                CASE
                    WHEN e.estimate_number LIKE \'%Rev%\' THEN
                        LEFT(e.estimate_number, CHAR_LENGTH(e.estimate_number) - 3)
                    ELSE e.estimate_number
                END AS base_estimate_number
            FROM crm_estimates e
            WHERE e.deleted = 0
        ),
        ValidEstimates AS (
            SELECT
                e.*
            FROM FilteredEstimates e
            LEFT JOIN FilteredEstimates rev
            ON e.estimate_number = rev.base_estimate_number
            AND rev.estimate_number LIKE \'%Rev%\'
            WHERE rev.estimate_number IS NULL
        )
        SELECT 
            id,
            first_name, 
            last_name, 
            COALESCE(SUM(total_sells), 0) AS total_sells,
            COALESCE(SUM(total_projects), 0) AS total_projects,
            COALESCE(SUM(total_clients), 0) AS total_clients,
            COALESCE(SUM(total_leads), 0) AS total_leads,
            COALESCE(SUM(total_prospects), 0) AS total_prospects,
            user_type, 
            image,  
            job_title, 
            last_online
        FROM (
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                COUNT(DISTINCT clients.id) AS total_clients,
                0 AS total_leads,
                0 AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS clients ON clients.id = ve.client_id AND clients.is_lead = 0 AND clients.deleted = 0
            LEFT JOIN crm_users u ON u.id = clients.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND u.status = \'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            GROUP BY u.id
        
            UNION ALL
        
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                0 AS total_clients,
                COUNT(DISTINCT leads.id) AS total_leads,
                0 AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS leads ON leads.id = ve.client_id AND leads.is_lead = 1 AND leads.lead_status_id = 1 AND leads.deleted = 0
            LEFT JOIN crm_users u ON u.id = leads.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND ve.deleted = 0 AND u.status = \'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            GROUP BY u.id
        
            UNION ALL
        
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                0 AS total_clients,
                0 AS total_leads,
                COUNT(DISTINCT prospect.id) AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS prospect ON prospect.id = ve.client_id AND prospect.is_lead = 1 AND prospect.lead_status_id > 1 AND prospect.deleted = 0
            LEFT JOIN crm_users u ON u.id = prospect.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND ve.deleted = 0 AND u.status = \'active\'  AND crm_users.role_id IN (6, 8, 9, 10)
            GROUP BY u.id
        ) AS combined
        GROUP BY 
            id')
 2 APPPATH\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers([...], false, null, null)
 3 APPPATH\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_overview', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_overview')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:47:14 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INT)
                    ELSE 0
                END AS revision_number
      ' at line 11 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('WITH FilteredEs...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('WITH FilteredEs...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('WITH FilteredEs...')
#3 E:\httpdocs\www\crm\app\Models\Users_model.php(593): CodeIgniter\Database\BaseConnection->query('WITH FilteredEs...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers(Array, false, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_o...', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_o...')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:47:14 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INT)
                    ELSE 0
                END AS revision_number
      ' at line 11
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Users_model.php(593): CodeIgniter\Database\BaseConnection->query('WITH FilteredEstimates AS (
            SELECT
                e.*,
                CASE
                    WHEN e.estimate_number LIKE \'%Rev%\' THEN
                        LEFT(e.estimate_number, CHAR_LENGTH(e.estimate_number) - 5)
                    ELSE e.estimate_number
                END AS base_estimate_number,
                CASE
                    WHEN e.estimate_number LIKE \'%Rev%\' THEN
                        CAST(SUBSTRING(e.estimate_number FROM POSITION(\'Rev\' IN e.estimate_number) + 3) AS INT)
                    ELSE 0
                END AS revision_number
            FROM crm_estimates e
            WHERE e.deleted = 0
        ),
        LatestRevisions AS (
            SELECT
                base_estimate_number,
                MAX(revision_number) AS latest_revision
            FROM FilteredEstimates
            GROUP BY base_estimate_number
        ),
        ValidEstimates AS (
            SELECT
                fe.*
            FROM FilteredEstimates fe
            INNER JOIN LatestRevisions lr
            ON fe.base_estimate_number = lr.base_estimate_number
            AND fe.revision_number = lr.latest_revision
        )
        SELECT 
            id,
            first_name, 
            last_name, 
            COALESCE(SUM(total_sells), 0) AS total_sells,
            COALESCE(SUM(total_projects), 0) AS total_projects,
            COALESCE(SUM(total_clients), 0) AS total_clients,
            COALESCE(SUM(total_leads), 0) AS total_leads,
            COALESCE(SUM(total_prospects), 0) AS total_prospects,
            user_type, 
            image,  
            job_title, 
            last_online
        FROM (
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                COUNT(DISTINCT clients.id) AS total_clients,
                0 AS total_leads,
                0 AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS clients ON clients.id = ve.client_id AND clients.is_lead = 0 AND clients.deleted = 0
            LEFT JOIN crm_users u ON u.id = clients.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND ve.deleted = 0 AND u.status = \'active\' 
            GROUP BY u.id
        
            UNION ALL
        
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                0 AS total_clients,
                COUNT(DISTINCT leads.id) AS total_leads,
                0 AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS leads ON leads.id = ve.client_id AND leads.is_lead = 1 AND leads.lead_status_id = 1 AND leads.deleted = 0
            LEFT JOIN crm_users u ON u.id = leads.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND ve.deleted = 0 AND u.status = \'active\' 
            GROUP BY u.id
        
            UNION ALL
        
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                0 AS total_clients,
                0 AS total_leads,
                COUNT(DISTINCT prospect.id) AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS prospect ON prospect.id = ve.client_id AND prospect.is_lead = 1 AND prospect.lead_status_id > 1 AND prospect.deleted = 0
            LEFT JOIN crm_users u ON u.id = prospect.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND ve.deleted = 0 AND u.status = \'active\' 
            GROUP BY u.id
        ) AS combined
        GROUP BY 
            id')
 2 APPPATH\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers([...], false, null, null)
 3 APPPATH\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_overview', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_overview')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 15:47:43 --> mysqli_sql_exception: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INTEGER)
                    ELSE 0
                END AS revision_number
  ' at line 11 in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('WITH FilteredEs...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('WITH FilteredEs...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('WITH FilteredEs...')
#3 E:\httpdocs\www\crm\app\Models\Users_model.php(593): CodeIgniter\Database\BaseConnection->query('WITH FilteredEs...')
#4 E:\httpdocs\www\crm\app\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers(Array, false, NULL, NULL)
#5 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
#6 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_o...', Array)
#7 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_o...')
#8 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard(Array)
#9 E:\httpdocs\www\crm\app\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
#10 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Dashboard->index()
#11 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
#12 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#13 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#14 {main}
CRITICAL - 2024-05-20 15:47:43 --> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INTEGER)
                    ELSE 0
                END AS revision_number
  ' at line 11
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 APPPATH\Models\Users_model.php(593): CodeIgniter\Database\BaseConnection->query('WITH FilteredEstimates AS (
            SELECT
                e.*,
                CASE
                    WHEN e.estimate_number LIKE \'%Rev%\' THEN
                        LEFT(e.estimate_number, CHAR_LENGTH(e.estimate_number) - 5)
                    ELSE e.estimate_number
                END AS base_estimate_number,
                CASE
                    WHEN e.estimate_number LIKE \'%Rev%\' THEN
                        CAST(SUBSTRING(e.estimate_number FROM POSITION(\'Rev\' IN e.estimate_number) + 3) AS INTEGER)
                    ELSE 0
                END AS revision_number
            FROM crm_estimates e
            WHERE e.deleted = 0
        ),
        LatestRevisions AS (
            SELECT
                base_estimate_number,
                MAX(revision_number) AS latest_revision
            FROM FilteredEstimates
            GROUP BY base_estimate_number
        ),
        ValidEstimates AS (
            SELECT
                fe.*
            FROM FilteredEstimates fe
            INNER JOIN LatestRevisions lr
            ON fe.base_estimate_number = lr.base_estimate_number
            AND fe.revision_number = lr.latest_revision
        )
        SELECT 
            id,
            first_name, 
            last_name, 
            COALESCE(SUM(total_sells), 0) AS total_sells,
            COALESCE(SUM(total_projects), 0) AS total_projects,
            COALESCE(SUM(total_clients), 0) AS total_clients,
            COALESCE(SUM(total_leads), 0) AS total_leads,
            COALESCE(SUM(total_prospects), 0) AS total_prospects,
            user_type, 
            image,  
            job_title, 
            last_online
        FROM (
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                COUNT(DISTINCT clients.id) AS total_clients,
                0 AS total_leads,
                0 AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS clients ON clients.id = ve.client_id AND clients.is_lead = 0 AND clients.deleted = 0
            LEFT JOIN crm_users u ON u.id = clients.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND ve.deleted = 0 AND u.status = \'active\' 
            GROUP BY u.id
        
            UNION ALL
        
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                0 AS total_clients,
                COUNT(DISTINCT leads.id) AS total_leads,
                0 AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS leads ON leads.id = ve.client_id AND leads.is_lead = 1 AND leads.lead_status_id = 1 AND leads.deleted = 0
            LEFT JOIN crm_users u ON u.id = leads.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND ve.deleted = 0 AND u.status = \'active\' 
            GROUP BY u.id
        
            UNION ALL
        
            SELECT 
                u.id,
                u.first_name, 
                u.last_name, 
                COALESCE(SUM(cfv.value), SUM(it.estimate_value)) AS total_sells,
                COUNT(DISTINCT ve.id) AS total_projects,
                0 AS total_clients,
                0 AS total_leads,
                COUNT(DISTINCT prospect.id) AS total_prospects,
                u.user_type, 
                u.image,  
                u.job_title, 
                u.last_online
            FROM ValidEstimates ve
            LEFT JOIN crm_clients AS prospect ON prospect.id = ve.client_id AND prospect.is_lead = 1 AND prospect.lead_status_id > 1 AND prospect.deleted = 0
            LEFT JOIN crm_users u ON u.id = prospect.owner_id
            LEFT JOIN crm_custom_fields cft ON cft.related_to = \'estimates\' AND cft.placeholder = \'Valor Estimado\'
            LEFT JOIN crm_custom_field_values cfv ON cfv.custom_field_id = cft.id AND cfv.related_to_id = ve.id
            LEFT JOIN (
                SELECT estimate_id, SUM(total) AS estimate_value
                FROM crm_estimate_items ei
                INNER JOIN crm_items i ON i.id = ei.item_id
                WHERE ei.deleted = 0
                GROUP BY estimate_id
            ) it ON it.estimate_id = ve.id
            WHERE u.deleted = 0 AND ve.deleted = 0 AND u.status = \'active\' 
            GROUP BY u.id
        ) AS combined
        GROUP BY 
            id')
 2 APPPATH\Helpers\widget_helper.php(1900): App\Models\Users_model->get_leads_sellers([...], false, null, null)
 3 APPPATH\Controllers\Dashboard.php(1231): sellers_leads_overview_widget()
 4 APPPATH\Controllers\Dashboard.php(1104): App\Controllers\Dashboard->_get_widgets_for_staffs('sellers_leads_overview', [...])
 5 APPPATH\Controllers\Dashboard.php(1081): App\Controllers\Dashboard->_make_dashboard_widgets('sellers_leads_overview')
 6 APPPATH\Controllers\Dashboard.php(437): App\Controllers\Dashboard->make_dashboard([...])
 7 APPPATH\Controllers\Dashboard.php(38): App\Controllers\Dashboard->view('1')
 8 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Dashboard->index()
 9 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Dashboard))
10 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
11 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
ERROR - 2024-05-20 17:07:16 --> mysqli_sql_exception: Duplicate entry '134' for key 'crm_estimates.PRIMARY' in E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php:295
Stack trace:
#0 E:\httpdocs\www\crm\system\Database\MySQLi\Connection.php(295): mysqli->query('INSERT INTO `cr...', 0)
#1 E:\httpdocs\www\crm\system\Database\BaseConnection.php(691): CodeIgniter\Database\MySQLi\Connection->execute('INSERT INTO `cr...')
#2 E:\httpdocs\www\crm\system\Database\BaseConnection.php(605): CodeIgniter\Database\BaseConnection->simpleQuery('INSERT INTO `cr...')
#3 E:\httpdocs\www\crm\system\Database\BaseBuilder.php(2309): CodeIgniter\Database\BaseConnection->query('INSERT INTO `cr...', Array, false)
#4 E:\httpdocs\www\crm\app\Models\Crud_model.php(199): CodeIgniter\Database\BaseBuilder->insert(Array)
#5 E:\httpdocs\www\crm\app\Controllers\Estimates.php(275): App\Models\Crud_model->ci_save(Array)
#6 E:\httpdocs\www\crm\system\CodeIgniter.php(939): App\Controllers\Estimates->save()
#7 E:\httpdocs\www\crm\system\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Estimates))
#8 E:\httpdocs\www\crm\system\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(NULL, Object(Config\Cache), false)
#9 E:\httpdocs\www\crm\index.php(80): CodeIgniter\CodeIgniter->run()
#10 {main}
CRITICAL - 2024-05-20 17:07:16 --> Duplicate entry '134' for key 'crm_estimates.PRIMARY'
in SYSTEMPATH\Database\BaseConnection.php on line 645.
 1 SYSTEMPATH\Database\BaseBuilder.php(2309): CodeIgniter\Database\BaseConnection->query('INSERT INTO `crm_estimates` (`id`, `status`) VALUES (:id:, :status:)', [...], false)
 2 APPPATH\Models\Crud_model.php(199): CodeIgniter\Database\BaseBuilder->insert([...])
 3 APPPATH\Controllers\Estimates.php(275): App\Models\Crud_model->ci_save([...])
 4 SYSTEMPATH\CodeIgniter.php(939): App\Controllers\Estimates->save()
 5 SYSTEMPATH\CodeIgniter.php(504): CodeIgniter\CodeIgniter->runController(Object(App\Controllers\Estimates))
 6 SYSTEMPATH\CodeIgniter.php(369): CodeIgniter\CodeIgniter->handleRequest(null, Object(Config\Cache), false)
 7 FCPATH\index.php(80): CodeIgniter\CodeIgniter->run()
